[gcode_macro Toolchange]
variable_p: -1
gcode:
  {% set p = printer["gcode_macro Toolchange"].p|int %}
  {% if p > -1 %}
  G100 T{p} E-50 F4500 N0
  {% endif %}
  G100 T{params.T} E55 F4500 N0
  SAVE_GCODE_VARIABLE MACRO=Toolchange VARIABLE=p VALUE={params.T}

[gcode_macro T0]
gcode:
  Toolchange T0

[gcode_macro T1]
gcode:
  Toolchange T1

[include ./steppers.cfg]
[include ./g100.cfg]